const bel = require('bel')
const csjs = require('csjs-inject')
// widgets
const Graphic = require('Graphic')

function Desktop(apps, tartget) {
    const csjs = require('csjs-inject')
    const css = style

    const desktop  = bel`<main class=${css.desktop} role="desktop"></main>`
    const el = bel`
        <div class=${css["app-list"]}>
        ${apps.map( app => {
            if (app.open) return
            return bel`
                <div class="${css.app} ${app.name}" onclick=${()=>tartget(app)}>
                    ${Graphic(app.url)}
                    <span class=${css.appName}>${app.title}</span>
                </div>`
            }
        )}
        </div>
    `

    desktop.appendChild(el)

    return desktop
}


const style = csjs`
.desktop {
    display: grid;
    grid-template-columns: auto;
    grid-template-rows: calc(100vh - 43px) 43px;
}
.app-list {
    padding: 20px 20px 0 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(auto, 88px));
    grid-template-rows: repeat(auto-fit, minmax(auto, 88px));
    gap: 5px 22px;
    grid-auto-flow: column;
    justify-items: center;
}
.app {
    display: grid;
    grid-template: 60px auto / auto;
    text-align: center;
    cursor: pointer;
    overflow: hidden;
}
.appName {
    font-size: var(--appNameFontSize);
    color: var(--appNameColor);
    word-break: break-word;
}
.app:hover div svg g path {
    fill: var(--appHoverColor);
}
.app:hover div svg g rect {
    fill: var(--appHoverColor);
}
.app:hover .appName {
    color: var(--appHoverColor);
    text-decoration: underline;
}
`

module.exports = Desktop