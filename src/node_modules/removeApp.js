const bel = require('bel')
const csjs = require('csjs-inject')
// widgets
const Graphic = require('Graphic')


function removeApp(packages, remove, arr) {

    let css = style
    let appName = remove.title.toLowerCase()
    // elements
    let el = document.querySelector(`.${appName}`)
    let appicon = el.querySelector('[class^="icon"]')
    let name = el.querySelector('[class^="app-name"]')

    packages.map( package => {
        if ( package.path.includes(appName) ) {
            package.status.app.install = false
            package.status.app.version = ''
        }
        return package
    })

    // update icon afeter removed
    let icon =  Graphic('./src/node_modules/assets/svg/application.svg', css.icon)
    // remove install icon
    appicon.remove()
    // update app icon
    el.insertBefore(icon, el.firstChild)
    // update app name
    name.innerHTML = `${remove.title}.install`

    return arr.splice(arr.indexOf(remove.title), 1)
}

let style = csjs`
.icon {
    width: 60px;
}
`

module.exports = removeApp